<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>粒子动画</title>
</head>
<style>
    body{
        margin:0;padding:0;width:100%;height:100%;
    }
    canvas{
        background: #ccc;
        position: absolute;left:0;top:0;bottom:0;
        right:0;margin:auto;
    }
</style>
<script>
window.onload=function(){
    var canvas=document.querySelector("canvas");
    var cobj=canvas.getContext("2d");
    /*function lizi(){
        this.r=Math.random()*5;
        this.color="red";
        this.x=400;
        this.y=400;
        this.width=10*Math.random()-5;
        this.height=100;
        this.speedx=Math.random()*5;
        this.speedy=1;
        this.zhongli=0.2;
        this.speedr=0.1;
    }
    lizi.prototype={
        draw:function(){
            cobj.save();
            cobj.beginPath();
            cobj.fillStyle=this.color;
            cobj.arc(this.x,this.y,this.r,0,2*Math.PI);
            cobj.fill();
            cobj.restore();
        },
        update:function(){
            this.y-=this.speedy;
            this.x+=this.speedx;
            this.speedy-=this.zhongli;
            this.r-=this.speedr;
        }
    }
    var arr=[];
    setInterval(function(){
        cobj.clearRect(0,0,1000,600);
        arr.push(new lizi());
        for(var i=0;i<arr.length;i++){
            arr[i].draw();
            arr[i].update();
            if(arr[i].r<0){
                arr[i]=new lizi();
            }
        }
        if(arr.length>100){
            arr.shift();
        }

    },100)*/
    /*粒子动画*/
    xue(200,200);
    function lizi(x,y){
        this.r=Math.random()*5;
        this.color="red";
        this.x=x;
        this.y=y;
        this.width=10*Math.random()-5;
        this.height=100;
        this.speedx=Math.random()*5;
        this.speedy=1;
        this.zhongli=0.2;
        this.speedr=0.1;
    }
    lizi.prototype={
        draw:function(){
            this.cobj.save();
            this.cobj.beginPath();
            this.cobj.fillStyle=this.color;
            this.cobj.translate(this.x,this.y);
            this.cobj.arc(0,0,this.r,0,2*Math.PI);
            this.cobj.fill();
            this.cobj.restore();
        },
        update:function(){
            this.y-=this.speedy;
            this.x+=this.speedx;
            this.speedy-=this.zhongli;
            this.r-=this.speedr;
        }
    }

    function xue(x,y){
        var arr=[];
        for(var i=0;i<30;i++){
            var obj=new lizi(x,y);
            arr.push(obj);
            alert(1)
        }
        var t=setInterval(function(){
            for(var i=0;i<arr.length;i++){
                alert(1)
                arr[i].draw();
                arr[i].update();
                if(arr[i].r<=0){
                    arr.splice(i,1);
                }
                if(arr.length==0){
                    clearInterval(t);
                }
            }
        },50)
    }
}
</script>
<body>
<canvas width="1000" height="600"></canvas>
</body>
</html>